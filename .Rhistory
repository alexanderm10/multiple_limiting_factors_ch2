install.packages("dplR")
install.packages("lattice")
install.packages("maps")
install.packages(c("raster", "rgdal", "ggplot2", "reshape2", "plyr"))
library(raster)
library(rgdal)
library(ggplot2)
library(reshape2)
library(plyr)
install.packages("devtools")
devtools::install_github("rstudio/packrat")
install.packages("kohonen")
library("kohonen")
data("wines")
View(wines)
wines.sc <- scale(wines)
set.seed(7)
wine.som <- som(data = wines.sc, grid = somgrid(5, 4, "hexagonal"))
plot(wine.som, main = "Wine data")
library("Hmisc", lib.loc="/Library/Frameworks/R.framework/Versions/3.1/Resources/library")
setwd("~/PhD/Carbon Research/ch2_multiple_limiting_factors")
library(ggplot2)
require(mgcv)
require(lsmeans)
require(car)
require(moments)
# Running ANOVA between Extreme years and normal years BAI for Canopy.Class
load("processed_data/gam2_weights_processed.Rdata")
summary(gam2.weights)
# Running ANOVA's to determine differences between ambient years and extreme years
# Using a lme here to take into account the differences between sites as random effeects
summary(gam2.weights)
# Truncating to 1950 becasue that's the extent of the climate analysis
gam2.weights <- gam2.weights[gam2.weights$Year >=1950,]
# cr.test <- lme(log(BA.inc) ~ Precip.Mark*Canopy.Class, random=list(group=~1, Site=~1, PlotID=~1, TreeID=~1), data=gam2.weights)
# lsmeans(cr.test, pairwise~Precip.Mark*Canopy.Class, adjust="tukey")
# cr.test2 <- lme(log(BA.inc) ~ Temp.Mark*Canopy.Class, random=list(TreeID=~1), data=gam2.weights)
# lsmeans(cr.test2, pairwise~Temp.Mark*Canopy.Class, adjust="tukey")
# Same fixed effects structure as the gams; add an interaction between temp & precip
# because we fit those jointly in the gam
cr.testD <- aov(log(BA.inc) ~ Precip.Mark*Temp.Mark + Site + PlotID + TreeID + group, data=gam2.weights[gam2.weights$Canopy.Class=="D",])
cr.testI <- aov(log(BA.inc) ~ Precip.Mark*Temp.Mark + Site + PlotID + TreeID + group, data=gam2.weights[gam2.weights$Canopy.Class=="I",])
cr.testS <- aov(log(BA.inc) ~ Precip.Mark*Temp.Mark + Site + PlotID + TreeID + group, data=gam2.weights[gam2.weights$Canopy.Class=="S",])
plot(resid(cr.testD) ~ predict(cr.testD))
plot(resid(cr.testI) ~ predict(cr.testI))
plot(resid(cr.testS) ~ predict(cr.testS))
summary(cr.testD)
tukey.d <- TukeyHSD(cr.testD)
# tukey.d["Precip.Mark:Temp.Mark"] # not significant, so we won't look at it
tukey.d["Precip.Mark"]
tukey.d["Temp.Mark"]
# Saving table to publication folder
write.table(summary(cr.testD), file="~/PhD/publications/2016/Ch2_multiple_limiting_factors/D_anova.txt")
summary(cr.testI)
tukey.i <- TukeyHSD(cr.testI)
# tukey.i["Precip.Mark:Temp.Mark"] # not significant, so we won't look at it
tukey.i["Precip.Mark"]
tukey.i["Temp.Mark"]
summary(cr.testS)
tukey.s <- TukeyHSD(cr.testS)
tukey.s["Precip.Mark:Temp.Mark"] # Significant (for better or worse)
tukey.s["Precip.Mark"]
tukey.s["Temp.Mark"]
# lsmeans(cr.testD, pairwise~Precip.Mark, adjust="tukey")
# lsmeans(cr.testD, pairwise~Temp.Mark, adjust="tukey")
# lsmeans(cr.testI, pairwise~Precip.Mark, adjust="tukey")
# lsmeans(cr.testS, pairwise~Precip.Mark, adjust="tukey")
tukey.d["Precip.Mark"]
tukey.d["Temp.Mark"]
tukey.i["Precip.Mark"]
tukey.i["Temp.Mark"]
tukey.s["Precip.Mark:Temp.Mark"] # Significant (for better or worse)
tukey.s["Precip.Mark"]
tukey.s["Temp.Mark"]
summary(cr.testI)
summary(cr.testD)
tukey.s["Precip.Mark:Temp.Mark"] # Significant (for better or worse)
tukey.s["Precip.Mark"]
tukey.s["Temp.Mark"]
tukey.s["Precip.Mark:Temp.Mark"] # Significant (for better or worse)
tukey.d["Precip.Mark"]
tukey.d["Temp.Mark"]
tukey.i["Precip.Mark"]
tukey.i["Temp.Mark"]
setwd("~/Dropbox/PhD/Carbon Research/ch2_multiple_limiting_factors")
library(mgcv)
library(ggplot2)
library(car)
library(reshape)
library(dplR)
library(DescTools)
# Christy's GAMM code
# gam1 <- gamm(Y ~  s(Biomass, bs="cr", k=3, by=PFT) + s(tair, k=k, by=PFT) + s(precipf, k=k, by=PFT) + s(CO2, k=k, by=PFT), random=list(PlotID=~1), data=data)
# Loading in my data
data.use <- read.csv("processed_data/AllSites_tree_plus_climate_and_BA.csv", header=T)
summary(data.use)
library(car)
library(dplR)
se <- function(x){
sd(x, na.rm=TRUE) / sqrt((length(!is.na(x))))}
core.data <- read.csv("~/PhD/Carbon Research/Calloc_TreeRingNPP/processed_data/DOE_core_data_may2016_update.csv", na.strings=c("", "NA", "#VALUE!", "*", " "), header=T)
core.data <- read.csv("DOE_core_data_may2016_update.csv", na.strings=c("", "NA", "#VALUE!", "*", " "), header=T)
core.data <- read.csv("~/PhD/Carbon Research/Calloc_TreeRingNPP/processed_data/DOE_core_data_may2016_update.csv", na.strings=c("", "NA", "#VALUE!", "*", " "), header=T)
core.data <- read.csv("~/PhD/Carbon Research/Calloc_TreeRingNPP/processed_data/DOE_core_data_may2016_update.csv", na.strings=c("", "NA", "#VALUE!", "*", " "), header=T)
summary(core.data)
data.use <- read.csv("processed_data/AllSites_tree_plus_climate_and_BA.csv", header=T)
data.use$group <- data.use$Species
data.use$group <- recode(data.use$group, "'CAOV' = 'CARYA'; 'CACO' = 'CARYA';
'CATE' = 'CARYA'; 'ACSAC' = 'ACSA'; 'BEAL' = 'BETULA'; 'BELE' = 'BETULA'; 'QUMU' = 'QUAL'")
data.use$group.plot <- as.factor(paste(data.use$group, data.use$PlotID, sep="."))
data.use$Canopy.Class <- recode(data.use$Canopy.Class, "'C' = 'D'")
summary(data.use)
# reducing the amount of data for the test runs
sites.use <- c("Harvard", "Howland", "Morgan Monroe State Park", "Oak Openings Toledo", "Missouri Ozark")
test <- data.use[data.use$Site %in% sites.use & !is.na(data.use$RW) & !is.na(data.use$BA.inc),]
summary(test)
test$group.cc <- as.factor(paste(test$group, test$Canopy.Class, sep="."))
summary(test)
# Get a list of what predictors & responses I'm using
predictors.all <- c("tmean", "precip", "Species", "dbh.recon", "Canopy.Class", "spp.plot", "group", "group.plot", "group.cc")
# Getting rid of observations that have NAs in the important variables
test <- test[complete.cases(test[,predictors.all]),]
test <- test[test$Live.Dead=="LIVE" & !test$Canopy.Class=="F",]
# Subsetting to a set of species that we have enough data to feel good about
#species.use <- c("TSCA", "QURU", "ACRU", "BEAL", "ACSA", "LITU", "QUAL", "CAOV", "CACO", "CATE", "JUVI", "QUVE", "PCRU", "THOC", "PIST")
group.use <- c("ACRU", "ACSA", "BETULA", "CARYA", "FAGR", "FRAX", "PIST", "QUAL", "QURU", "QUVE", "SAAL", "TSCA", "ULRU")
test <- test[test$group %in% group.use,]
summary(test)
summary(tree.rw)
library(mgcv)
library(ggplot2)
library(car)
library(reshape)
library(dplR)
library(DescTools)
# Christy's GAMM code
# gam1 <- gamm(Y ~  s(Biomass, bs="cr", k=3, by=PFT) + s(tair, k=k, by=PFT) + s(precipf, k=k, by=PFT) + s(CO2, k=k, by=PFT), random=list(PlotID=~1), data=data)
# Loading in my data
data.use <- read.csv("processed_data/AllSites_tree_plus_climate_and_BA.csv", header=T)
data.use$group <- data.use$Species
data.use$group <- recode(data.use$group, "'CAOV' = 'CARYA'; 'CACO' = 'CARYA';
'CATE' = 'CARYA'; 'ACSAC' = 'ACSA'; 'BEAL' = 'BETULA'; 'BELE' = 'BETULA'; 'QUMU' = 'QUAL'")
data.use$group.plot <- as.factor(paste(data.use$group, data.use$PlotID, sep="."))
data.use$Canopy.Class <- recode(data.use$Canopy.Class, "'C' = 'D'")
summary(data.use)
# reducing the amount of data for the test runs
sites.use <- c("Harvard", "Howland", "Morgan Monroe State Park", "Oak Openings Toledo", "Missouri Ozark")
test <- data.use[data.use$Site %in% sites.use & !is.na(data.use$RW) & !is.na(data.use$BA.inc),]
summary(test)
test$group.cc <- as.factor(paste(test$group, test$Canopy.Class, sep="."))
summary(test)
# Get a list of what predictors & responses I'm using
predictors.all <- c("tmean", "precip", "Species", "dbh.recon", "Canopy.Class", "spp.plot", "group", "group.plot", "group.cc")
# Getting rid of observations that have NAs in the important variables
test <- test[complete.cases(test[,predictors.all]),]
test <- test[test$Live.Dead=="LIVE" & !test$Canopy.Class=="F",]
# Subsetting to a set of species that we have enough data to feel good about
#species.use <- c("TSCA", "QURU", "ACRU", "BEAL", "ACSA", "LITU", "QUAL", "CAOV", "CACO", "CATE", "JUVI", "QUVE", "PCRU", "THOC", "PIST")
group.use <- c("ACRU", "ACSA", "BETULA", "CARYA", "FAGR", "FRAX", "PIST", "QUAL", "QURU", "QUVE", "SAAL", "TSCA", "ULRU")
test <- test[test$group %in% group.use,]
summary(test)
# Right now just looking at the dominant trees.  Not sure how to show this yet
# test <- test[test$Canopy.Class=="D",]
par(new=F)
plot(test[test$TreeID=="MMA003", "BA.inc"]~ test[test$TreeID=="MMA003","Year"], type="l")
summary(test)
# Truncatign at 1935; at 1935 the sample depth for the oak openings is only 1
test <- test[test$Year >= 1935 & test$Year <= 2012,]
tree.rw <- test
summary(tree.rw)
summary(test)
save(test, file="processed_data/test_tree_data_1935_2012.Rdata")
sites.rw <- list()
tree.rw$Year <- as.factor(tree.rw$Year)
summary(tree.rw)
head(tree.rw)
for(s in unique(tree.rw$Site)){
sites.rw[[s]] <- recast(tree.rw[tree.rw$Site==s,c("Year", "TreeID", "RW")], Year ~ TreeID)
}
summary(sites.rw)
library(recast2)
library(recast)
library(cast)
library(cast2)
