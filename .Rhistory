install.packages("dplR")
install.packages("lattice")
install.packages("maps")
install.packages(c("raster", "rgdal", "ggplot2", "reshape2", "plyr"))
library(raster)
library(rgdal)
library(ggplot2)
library(reshape2)
library(plyr)
install.packages("devtools")
devtools::install_github("rstudio/packrat")
install.packages("kohonen")
library("kohonen")
data("wines")
View(wines)
wines.sc <- scale(wines)
set.seed(7)
wine.som <- som(data = wines.sc, grid = somgrid(5, 4, "hexagonal"))
plot(wine.som, main = "Wine data")
library("Hmisc", lib.loc="/Library/Frameworks/R.framework/Versions/3.1/Resources/library")
setwd("~/PhD/Carbon Research/multiple_limiting_factors_ch2")
###################################################
# Copied over from 0_process_gamm.R
# This will give us the sensitivities of RW in a pretty format.
# Set up a dummy dataset for the script to run correctly
# number of simulations to run
load("processed_data/gam_results/gam1_climate_by_species.Rdata")
source("0_Calculate_GAMM_Posteriors.R")
# Fitting our model to the data to see if we're doing a pasable job of capturing the variance
# If things don't match, we shoudl take our sensitiivty curves with a grain of salt
n <- 100
model.pred <- post.distns(model.gam=gam1, model.name="species_response", newdata=test, vars=predictors.all, n=n, terms=F)
summary(model.pred$ci)
# Need help dealing with the list that is set up here.  Need help with the aggregation
model.pred2 <- model.pred$ci
summary(model.pred2)
dim(model.pred2)
# Aggregating to the group level in teh same way we do below with the ring widths
# We can then compare our modeled RW to our measured RW and see how things look
# Sanity Check #1
mean.model <- aggregate(model.pred2$mean, by = model.pred2[, c("group", "Site", "Year")], FUN=mean, na.rm=T)
names(mean.model)[names(mean.model)=="x"] <- c("BAI.mean")
mean.model[,"BAI.lwr"] <- aggregate(model.pred2$mean, by=model.pred2[,c("group", "Site", "Year")], FUN=quantile, probs=0.025, na.rm=T)[,"x"]
mean.model[,"BAI.upr"] <- aggregate(model.pred2$mean, by=model.pred2[,c("group", "Site", "Year")], FUN=quantile, probs=0.975, na.rm=T)[,"x"]
head(mean.model)
# aggregating the raw data for graphing
mean.rw <- aggregate(test$BA.inc, by=test[, c("group", "Site", "Year")], FUN=mean, na.rm=T)
names(mean.rw)[names(mean.rw)=="x"]<- c("BAI.mean")
# mean.rw[,"rw.lwr"] <- aggregate(test$RW, by=test[,c("group", "Site", "Year")], FUN=quantile, probs=0.025, na.rm=T)[,"x"]
# mean.rw[,"rw.upr"] <- aggregate(test$RW, by=test[,c("group", "Site", "Year")], FUN=quantile, probs=0.975, na.rm=T)[,"x"]
# mean.rw[,"BAI.mean"] <- aggregate(test$BA.inc, by=test[,c("group", "Site", "Year")], FUN=mean, na.rm=T)[,"x"]
mean.rw[,"BAI.lwr"] <- aggregate(test$BA.inc, by=test[,c("group", "Site", "Year")], FUN=quantile, probs=0.025, na.rm=T)[,"x"]
mean.rw[,"BAI.upr"] <- aggregate(test$BA.inc, by=test[,c("group", "Site", "Year")], FUN=quantile, probs=0.975, na.rm=T)[,"x"]
head(mean.rw)
mean.rw <- mean.rw[mean.rw$Site %in% sites.use,]
#mean.rw$Species <- mean.rw$group
# Setting up lm between the modeled values and the observed
dim(mean.rw)
dim(mean.model)
# mean.rw <- mean.rw[mean.rw$group %in% mean.model$group,]
# mean.rw <- mean.rw[mean.rw$Year %in% mean.model$Year,]
summary(mean.rw);
summary(mean.model)
mean.model2 <- mean.model
names(mean.model2)[4:6] <- c("mod.mean", "mod.lwr", "mod.up")
sanity.gam1.df <- merge(mean.model2, mean.rw, all.x=T, all.y=T)
summary(sanity.gam1.df)
summary(sanity.gam1.df[is.na(sanity.gam1.df$mod.mean),])
head(sanity.gam1.df[is.na(sanity.gam1.df$mod.mean),])
load("processed_data/gam_results/gam1_climate_by_species.Rdata")
source("0_Calculate_GAMM_Posteriors.R")
n <- 100
model.pred <- post.distns(model.gam=gam1, model.name="species_response", newdata=test, vars=predictors.all, n=n, terms=F)
summary(model.pred$ci)
setwd("~/PhD/Carbon Research/multiple_limiting_factors_ch2")
model.pred <- post.distns(model.gam=gam1, model.name="species_response", newdata=test, vars=predictors.all, n=n, terms=F)
summary(model.pred$ci)
source("0_Calculate_GAMM_Posteriors.R")
n <- 100
model.pred <- post.distns(model.gam=gam1, model.name="species_response", newdata=test, vars=predictors.all, n=n, terms=F)
source("0_Calculate_GAMM_Posteriors.R")
n <- 100
model.pred <- post.distns(model.gam=gam1, model.name="species_response", newdata=test, vars=predictors.all, n=n, terms=F)
